!function(e,t){"use strict";e.module("jett.ionic.scroll.sista",["ionic"]).directive("scrollSista",["$document","$timeout","$rootScope","$ionicScrollDelegate",function(a,n,o,r){var i=400,c=2*i,s=i+"ms",l=t.Platform.isAndroid()?!1:!0,u=!0;return{restrict:"A",link:function(o,i,f){function d(e,a,o){o&&!e.style[t.CSS.TRANSITION_DURATION]&&(e.style[t.CSS.TRANSITION_DURATION]=o,n(function(){e.style[t.CSS.TRANSITION_DURATION]=""},c,!1)),e.style[t.CSS.TRANSFORM]="translate3d(0, "+-a+"px, 0)"}function S(){p=0,y=0,N=0}function b(){if(T=H.querySelector('[nav-bar="cached"] .bar-header'),$=H.querySelector('[nav-bar="active"] .bar-header'))switch(A=$.offsetHeight,M=A,R=H.querySelector(".tabs"),R&&(I=R.offsetHeight,R.parentNode.classList.contains("tabs-top")?(D=!0,M+=I):R.parentNode.classList.contains("tabs-bottom")&&(F=!0)),g=H.querySelector(".bar-subheader"),g&&(v=g.offsetHeight,M+=v),x=2*M,O=k=C=x,I=I||0,v=v||0,f.scrollSista){case"header":C=A,k=D?A:0;break;case"header-tabs":L=D?I:0,C=D?A+I:A;break;case"tabs-subheader":O=0,L=D?M-A:v,U=D?v:0;break;case"tabs":O=0,C=D?I:0;break;case"subheader":O=0,k=0;break;default:L=D?M-A:v,U=D?v:0}}function h(a,n){var o=Math.max(0,1-a/A);d($,a,n),e.forEach($.children,function(e){e.style.opacity=o,l&&(e.style[t.CSS.TRANSFORM]="scale("+o+","+o+")")}),d(T,a,n)}function m(e,a){var n,o,r=i[0].style,c=e>L?e-L:0;t.requestAnimationFrame(function(){g&&(o=e>V?e-V:0,d(g,Math.min(C,o),a)),R&&(n=Math.min(k,e>U?e-U:0),F&&(n=-n,r.bottom=Math.max(0,I-e)+"px"),d(R,n,a)),h(Math.min(O,c),a),r.top=Math.max(0,M-e)+"px"})}var p,y,N,T,$,A,M,g,v,R,I,x,O,k,C,H=a[0].body,q=f.delegateHandle?r.$getByHandle(f.delegateHandle):r,w=q.getScrollView(),D=!1,F=!1,L=0,U=0,V=0;o.$on("scroll.refreshComplete",function(){S()}),o.$parent.$on("$ionicView.beforeLeave",function(){u=!0,m(0),q&&q.scrollTop()}),o.$parent.$on("$ionicView.afterEnter",function(){S(),n(function(){b(),u=!1},20,!1)}),i.bind("scroll",function(e){if(!u){var t=0,a=e.detail.scrollTop;p=a>=0?Math.min(x,Math.max(0,p+a-N)):0,w.getScrollMax().top-a<=M&&(p=0,t=s),N=a,y!==p&&(y=p,m(p,t))}})}}}])}(angular,ionic);