!function(e,t){"use strict";e.module("jett.ionic.scroll.sista",["ionic"]).directive("scrollSista",["$document","$timeout","$rootScope","$ionicScrollDelegate",function(a,n,r,o){function i(e,t,a,n){var r;for(n=n||10;e.parentNode&&n--;){if(r=e.parentNode.getAttribute(t),r&&r===a)return e.parentNode;e=e.parentNode}return null}var c=400,s=2*c,l=c+"ms",u=t.Platform.isAndroid()?!1:!0;return{restrict:"A",link:function(r,c,f){function d(e,a,r){r&&!e.style[t.CSS.TRANSITION_DURATION]&&(e.style[t.CSS.TRANSITION_DURATION]=r,n(function(){e.style[t.CSS.TRANSITION_DURATION]=""},s,!1)),e.style[t.CSS.TRANSFORM]="translate3d(0, "+-a+"px, 0)"}function b(){m=0,N=0,v=0}function h(){var e;if($=H.querySelector('[nav-bar="cached"] .bar-header'),y=H.querySelector('[nav-bar="active"] .bar-header'))switch(A=y.offsetHeight,T=A,R=H.querySelectorAll(".tabs"),R=R[R.length-1],R&&(I=R.offsetHeight,R.parentNode.classList.contains("tabs-top")?(V=!0,T+=I):R.parentNode.classList.contains("tabs-bottom")&&(E=!0)),e=i(c[0],"nav-view","active"),g=e.querySelector(".bar-subheader"),g&&(M=g.offsetHeight,T+=M),k=2*T,x=O=w=k,I=I||0,M=M||0,f.scrollSista){case"header":w=A,O=V?A:0;break;case"header-tabs":F=V?I:0,w=V?A+I:A;break;case"tabs-subheader":x=0,F=V?T-A:M,L=V?M:0;break;case"tabs":x=0,w=V?I:0;break;case"subheader":x=0,O=0;break;case"header-subheader":O=V?A:0;break;case"subheader-header":F=M,L=V?M:0,O=V?A:0;break;default:F=V?T-A:M,L=V?M:0}}function S(a,n){var r=Math.max(0,1-a/A);d(y,a,n),e.forEach(y.children,function(e){e.style.opacity=r,u&&(e.style[t.CSS.TRANSFORM]="scale("+r+","+r+")")}),d($,a,n)}function p(e,a){var n,r,o=c[0].style,i=e>F?e-F:0;t.requestAnimationFrame(function(){g&&(r=e>U?e-U:0,d(g,Math.min(w,r),a)),R&&(n=Math.min(O,e>L?e-L:0),E&&(n=-n,o.bottom=Math.max(0,I-e)+"px"),d(R,n,a)),S(Math.min(x,i),a),o.top=Math.max(0,T-e)+"px"})}var m,N,v,$,y,A,T,g,M,R,I,k,x,O,w,C=!0,H=a[0].body,q=f.delegateHandle?o.$getByHandle(f.delegateHandle):o,D=q.getScrollView(),V=!1,E=!1,F=0,L=0,U=0;r.$on("scroll.refreshComplete",function(){b()}),r.$parent.$on("$ionicView.beforeLeave",function(){C=!0,p(0)}),r.$parent.$on("$ionicView.beforeEnter",function(){q&&q.scrollTop()}),r.$parent.$on("$ionicView.afterEnter",function(){b(),n(function(){h(),C=!1},20,!1)}),c.bind("scroll",function(e){if(!C){var t=0,a=e.detail.scrollTop;m=a>=0?Math.min(k,Math.max(0,m+a-v)):0,D.getScrollMax().top-a<=T&&(m=0,t=l),v=a,N!==m&&(N=m,p(m,t))}})}}}])}(angular,ionic);