!function(e,t){"use strict";e.module("jett.ionic.scroll.sista",["ionic"]).directive("scrollSista",["$document","$timeout","$rootScope","$ionicScrollDelegate",function(a,r,n,o){var i=400,c=2*i,s=i+"ms",l=t.Platform.isAndroid()?!1:!0;return{restrict:"A",link:function(n,i,u){function d(e,a,n){n&&!e.style[t.CSS.TRANSITION_DURATION]&&(e.style[t.CSS.TRANSITION_DURATION]=n,r(function(){e.style[t.CSS.TRANSITION_DURATION]=""},c,!1)),e.style[t.CSS.TRANSFORM]="translate3d(0, "+-a+"px, 0)"}function f(){m=0,p=0,y=0}function b(){N=C.querySelector('[nav-bar="cached"] .bar-header'),T=C.querySelector('[nav-bar="active"] .bar-header')}function h(a,r){var n=Math.max(0,1-a/v);d(T,a,r),e.forEach(T.children,function(e){e.style.opacity=n,l&&(e.style[t.CSS.TRANSFORM]="scale("+n+","+n+")")}),d(N,a,r)}function S(e,a){var r,n,o=i[0].style,c=e>L?e-L:0;t.requestAnimationFrame(function(){A&&(n=e>V?e-V:0,d(A,Math.min(O,n),a)),g&&(r=Math.min(x,e>U?e-U:0),F&&(r=-r,o.bottom=Math.max(0,R-e)+"px"),d(g,r,a)),h(Math.min(k,c),a),o.top=Math.max(0,$-e)+"px"})}var m,p,y,N,T,v,$,A,M,g,R,I,k,x,O,q=!0,C=a[0].body,H=u.delegateHandle?o.$getByHandle(u.delegateHandle):o,w=H.getScrollView(),D=!1,F=!1,L=0,U=0,V=0;!function(){var e=C.querySelector("[nav-bar] .bar-header");if(e)switch(v=e.offsetHeight,$=v,g=C.querySelector(".tabs"),g&&(R=g.offsetHeight,g.parentNode.classList.contains("tabs-top")?(D=!0,$+=R):g.parentNode.classList.contains("tabs-bottom")&&(F=!0)),A=C.querySelector(".bar-subheader"),A&&(M=A.offsetHeight,$+=M),I=2*$,k=x=O=I,R=R||0,M=M||0,u.scrollSista){case"header":O=v,x=D?v:0;break;case"header-tabs":L=D?R:0,O=D?v+R:v;break;case"tabs-subheader":k=0,L=D?$-v:M,U=D?M:0;break;case"tabs":k=0,O=D?R:0;break;case"subheader":k=0,x=0;break;case"header-subheader":x=D?v:0;break;case"subheader-header":L=M,U=D?M:0,x=D?v:0;break;default:L=D?$-v:M,U=D?M:0}}(),n.$on("scroll.refreshComplete",function(){f()}),n.$parent.$on("$ionicView.beforeLeave",function(){q=!0,S(0),H&&H.scrollTop()}),n.$parent.$on("$ionicView.afterEnter",function(){f(),r(function(){b(),q=!1},20,!1)}),i.bind("scroll",function(e){if(!q){var t=0,a=e.detail.scrollTop;m=a>=0?Math.min(I,Math.max(0,m+a-y)):0,w.getScrollMax().top-a<=$&&(m=0,t=s),y=a,p!==m&&(p=m,S(m,t))}})}}}])}(angular,ionic);